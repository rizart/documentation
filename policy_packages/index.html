<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.74">
<link rel="alternate" type="application/rss+xml" href="/documentation/blog/rss.xml" title="Rucio Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/documentation/blog/atom.xml" title="Rucio Documentation Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Rucio Documentation" href="/documentation/opensearch.xml">
<link rel="stylesheet" href="/documentation/css/custom.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:400,500,700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Policy Packages | Rucio Documentation</title><meta data-react-helmet="true" property="og:url" content="https://rucio.github.io/documentation/policy_packages"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Policy Packages | Rucio Documentation"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/documentation/img/android-chrome-512x512.png"><link data-react-helmet="true" rel="canonical" href="https://rucio.github.io/documentation/policy_packages"><link data-react-helmet="true" rel="alternate" href="https://rucio.github.io/documentation/policy_packages" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://rucio.github.io/documentation/policy_packages" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/documentation/assets/css/styles.32adc92d.css">
<link rel="preload" href="/documentation/assets/js/styles.de28298d.js" as="script">
<link rel="preload" href="/documentation/assets/js/runtime~main.d7ca73f4.js" as="script">
<link rel="preload" href="/documentation/assets/js/main.545e8c33.js" as="script">
<link rel="preload" href="/documentation/assets/js/1.6e9b3614.js" as="script">
<link rel="preload" href="/documentation/assets/js/2.d7582743.js" as="script">
<link rel="preload" href="/documentation/assets/js/384.603d4a66.js" as="script">
<link rel="preload" href="/documentation/assets/js/387.e975f881.js" as="script">
<link rel="preload" href="/documentation/assets/js/935f2afb.1c30bcea.js" as="script">
<link rel="preload" href="/documentation/assets/js/17896441.d8601507.js" as="script">
<link rel="preload" href="/documentation/assets/js/040696f8.e955239f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/documentation/"><img src="/documentation/img/rucio_horizontaled_black.svg" alt="Rucio Documentation" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/documentation/img/rucio_horizontaled_white.svg" alt="Rucio Documentation" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Rucio Documentation</strong></a><a class="navbar__item navbar__link" href="/documentation/client_api/accountclient">Python Client API</a><a href="/documentation/html/rest_api_doc.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">REST API</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/documentation/"><img src="/documentation/img/rucio_horizontaled_black.svg" alt="Rucio Documentation" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/documentation/img/rucio_horizontaled_white.svg" alt="Rucio Documentation" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Rucio Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/documentation/client_api/accountclient">Python Client API</a></li><li class="menu__list-item"><a href="/documentation/html/rest_api_doc.html" target="_blank" rel="noopener noreferrer" class="menu__link">REST API</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/documentation/">Welcome</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/before_you_get_started">Before you get started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/what_is_rucio">What is Rucio?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/main_components">Main Components</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/additional_layers_and_resources">Additional Layers and Resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/requirements">Requirements</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/rucio_account">Rucio account</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/file_dataset_container">Files, Datasets, and Containers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/rucio_storage_element">Rucio Storage Element</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/metadata_attributes">Metadata attributes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/permission_model">Permission model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/replica_management">Replica management with replication rules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/replication_rules_examples">Replication rule examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/rse_expressions">RSE Expressions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/accounting_and_quota">Accounting and quota</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/notifications">Notifications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/subscriptions">Subscriptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/replica_workflow">Typical Replica Workflow</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/releasepolicy">Release Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/release-notes">Release Notes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">User</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/setting_up_the_rucio_client">Setting Up the Rucio Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/using_the_client">Using the Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/using_the_admin_client">Using the Admin Client</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Python Client API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/accountclient">AccountClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/accountlimitclient">AccountLimitClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/baseclient">BaseClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/client">Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/configclient">ConfigClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/credentialclient">CredentialClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/didclient">DIDClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/diracclient">DiracClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/downloadclient">DownloadClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/exportclient">ExportClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/fileclient">FileClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/importclient">ImportClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/lifetimeclient">LifetimeClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/lockclient">LockClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/metaclient">MetaClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/pingclient">PingClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/replicaclient">ReplicaClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/requestclient">RequestClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/rseclient">RSEClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/ruleclient">RuleClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/scopeclient">ScopeClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/subscriptionclient">SubscriptionClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/touchclient">TouchClient</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/client_api/uploadclient">UploadClient</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Operator</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/installing_server">Installing Rucio Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/installing_daemons">Installing Rucio Daemons</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/monitoring">Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/database">Database Operations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/administration">Administration Tricks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/configuration_parameters">Configuration parameters</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Transfers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/transfers-overview">Transfers Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/transfers-submitter">Transfers Submitter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/configure-rucio-globus">Configure Rucio To Use Globus Online as a Transfer Tool</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/documentation/policy_packages">Policy Packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/s3_rse_config">S3 Storage Configuration</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Executables</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-abacus-account">rucio-abacus-account</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-abacus-collection-replica">rucio-abacus-collection-replica</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-abacus-rse">rucio-abacus-rse</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-admin">rucio-admin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-atropos">rucio-atropos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-auditor">rucio-auditor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-automatix">rucio-automatix</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-bb8">rucio-bb8</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-c3po">rucio-c3po</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-cache-client">rucio-cache-client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-cache-consumer">rucio-cache-consumer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-conveyor-finisher">rucio-conveyor-finisher</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-conveyor-poller">rucio-conveyor-poller</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-conveyor-preparer">rucio-conveyor-preparer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-conveyor-receiver">rucio-conveyor-receiver</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-conveyor-stager">rucio-conveyor-stager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-conveyor-submitter">rucio-conveyor-submitter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-conveyor-throttler">rucio-conveyor-throttler</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-dark-reaper">rucio-dark-reaper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-dumper">rucio-dumper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-follower">rucio-follower</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-hermes">rucio-hermes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-hermes2">rucio-hermes2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-judge-cleaner">rucio-judge-cleaner</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-judge-evaluator">rucio-judge-evaluator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-judge-injector">rucio-judge-injector</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-judge-repairer">rucio-judge-repairer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-kronos">rucio-kronos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-light-reaper">rucio-light-reaper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-minos-temporary-expiration">rucio-minos-temporary-expiration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-minos">rucio-minos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-necromancer">rucio-necromancer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-oauth-manager">rucio-oauth-manager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-reaper">rucio-reaper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-replica-recoverer">rucio-replica-recoverer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-storage-consistency-actions">rucio-storage-consistency-actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-transmogrifier">rucio-transmogrifier</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio-undertaker">rucio-undertaker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/bin/rucio">rucio</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Developer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/setting_up_demo">Setting up a Rucio demo environment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/developing_with_rucio">Developing with Rucio</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/contributing">Contributing Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/rest_api_doc">Rest Api Documentation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/component_leads">Component leads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/type_annotation_guide">Type Annotation Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About Us</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/about_our_contributors">About Our Contributors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/documentation/contact_us">Contact us</a></li></ul></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">Policy Packages</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>Policy packages are separate Python packages that can be used to add
experiment-specific customisations to Rucio. They typically customise
Rucio&#x27;s handling of permissions and schema as well as optionally adding
their own algorithms for various purposes, such as lfn to pfn conversion
and surl construction.</p><p>Policy packages may be installed from a Python package repository such
as <a href="https://pypi.python.org/" target="_blank" rel="noopener noreferrer">PyPi</a> or they may simply be installed in a
local directory. In the latter case this directory will need to be added
to the Rucio server&#x27;s <code>PYTHONPATH</code> environment variable.</p><p>The name of the policy package in use is specified by the <code>package</code> value
in the <code>policy</code> section of the Rucio configuration file. Alternatively,
the package can be specified by the <code>RUCIO_POLICY_PACKAGE</code> environment
variable (if both are set, the environment variable takes priority). If
no package is specified, a built in generic policy will be used. If a
package is specified but cannot be loaded, Rucio will exit with an error.</p><p>Multi-VO Rucio installations can load a different policy package for each
VO. In this case, the configuration parameter or environment variable name
is suffixed with the VO name (for example, <code>package-vo1</code> or
<code>RUCIO_POLICY_PACKAGE_VO1</code>).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="creating-a-policy-package"></a>Creating a policy package<a class="hash-link" href="#creating-a-policy-package" title="Direct link to heading">#</a></h2><p>The structure of a policy package is very simple. It contains the
following:</p><ul><li>A <code>permission.py</code> module implementing permission
customisations.</li><li>A <code>schema.py</code> module implementing schema customisations.</li><li>An <code>__init__.py</code> file that can optionally return a dictionary of
algorithms provided by the package.</li><li>It should also contain a SUPPORTED_VERSION field.</li></ul><p>The easiest way to create the <code>permission.py</code> and
<code>schema.py</code> modules is to modify the generic versions from
the Rucio codebase. These can be found in
<code>lib/rucio/core/permission/generic.py</code> and
<code>lib/rucio/common/schema/generic.py</code> respectively.</p><p>In the <code>has_permission</code> function you may wish to default to
the generic permission checks if your experiment does not need specific
functionality for a particular action, or so that new actions added to
Rucio will work without your policy package having to be updated. This
fallback can be implemented with code similar to the following:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> rucio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">core</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">permission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">generic</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> action </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> perm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> rucio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">core</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">permission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">generic</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">has_permission</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">issuer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> kwargs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p><code>__init__.py</code> should include a
<code>SUPPORTED_VERSION</code> field indicating the version of Rucio
that your package was developed against. This may be checked by Rucio in
the event that the policy package interface changes in the future.
Example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">SUPPORTED_VERSION </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1.20.7&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>It can also contain an optional function called <code>get_algorithms</code> that
returns a dictionary of custom algorithms implemented within the package.
In fact, this structure should be a &quot;dictionary of dictionaries&quot; where
the outer dictionary contains algorithm types, and each inner
dictionary contains all the algorithms provided by the package for that
type. Currently supported types are <code>surl</code> for SURL algorithms,
<code>lfn2pfn</code> for LFN2PFN algorithms, and <code>scope</code> for scope extraction
algorithms.</p><p>Example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_algorithms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;surl&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;voname_surl&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> construct_surl_voname </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;lfn2pfn&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;voname_lfn2pfn&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> lfn2pfn_voname </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;scope&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;voname_extract_scope&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> extract_scope_voname </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>In all cases the names used to register the functions must be prefixed
with the name of the virtual organisation that owns the policy package,
to avoid naming conflicts on multi-VO Rucio installations.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="deploying-policy-packages-in-containers"></a>Deploying Policy Packages in containers<a class="hash-link" href="#deploying-policy-packages-in-containers" title="Direct link to heading">#</a></h2><p>It is now common to deploy Rucio using containers managed by software
such as Docker and Kubernetes. This section of the documentation is
intended to give guidance on how policy packages can be deployed in
this type of environment.</p><p>Broadly speaking, three things must happen in order for a policy
package to be deployed successfully:</p><ol><li>The policy package code must be available to the Rucio server
(and possibly other components such as daemons).</li><li>The directory containing the policy package must be in the server&#x27;s
<code>PYTHONPATH</code>.</li><li>The policy package name must be set in the Rucio configuration file,
or using the <code>RUCIO_POLICY_PACKAGE</code> environment variable.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="installing-the-policy-package"></a>Installing the policy package<a class="hash-link" href="#installing-the-policy-package" title="Direct link to heading">#</a></h3><p>There are a few possible ways to get the policy package code into the
container where the server runs. One way is to build a custom
experiment-specific container image based on the generic Rucio server
image, and to install the policy package at build time in the
<code>Dockerfile</code>, either by directly copying the files in, or by installing
it from some sort of repository. For experiments that already customise
the container image, this is likely to be the easiest option.</p><p>Alternatively, the standard Rucio container can be used and a volume
containing the policy package files can be mounted at run time (using
the <code>-v</code> or <code>--volume</code> command line flag). When using Kubernetes, there
is also a third possibility: use an
<a href="https://kubernetes.io/docs/concepts/workloads/pods/init-containers/" target="_blank" rel="noopener noreferrer">init container</a>
to install the policy package onto a shared volume, which is then mounted
by the server container when it starts up.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="adding-the-policy-package-to-the-servers-pythonpath"></a>Adding the policy package to the server&#x27;s PYTHONPATH<a class="hash-link" href="#adding-the-policy-package-to-the-servers-pythonpath" title="Direct link to heading">#</a></h3><p>It is possible to set environment variables within the container when
starting it (using Docker&#x27;s <code>-e</code> command line flag). This can be used to
set <code>PYTHONPATH</code>, however this will replace the original value rather
than appending to it, so there is a risk of removing other important
items from the path. A safer option is to override Rucio&#x27;s
<code>docker-entrypoint.sh</code> script and instead use a script that appends the
policy package&#x27;s directory to <code>PYTHONPATH</code> before starting the HTTP server.
This can be done either at build time in the <code>Dockerfile</code>, or at run time
using the <code>--entrypoint</code> command line option.</p><p>When deploying using Kubernetes and Helm charts, it is possible to specify
the policy package directory in the <code>optional_config:</code> section of
<code>values.yaml</code>. This is then propagated to the container as an environment
variable, which can be added to <code>PYTHONPATH</code> by the entry point script. For
example, include this in <code>values.yaml</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">optional_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">policy_pkg_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /opt/rucio/policy</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This will appear in the container&#x27;s environment as a variable called
<code>POLICY_PKG_PATH</code>, which can be added to <code>PYTHONPATH</code> by the entry point
script before starting the server:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"> -z </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$POLICY_PKG_PATH</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">then</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PYTHONPATH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">${POLICY_PKG_PATH}</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">${PYTHONPATH</span><span class="token variable operator" style="color:rgb(137, 221, 255)">:+</span><span class="token variable operator" style="color:rgb(137, 221, 255)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">}</span><span class="token variable" style="color:rgb(191, 199, 213)">${PYTHONPATH}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">fi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="specifying-the-policy-package-in-the-configuration-file"></a>Specifying the policy package in the configuration file<a class="hash-link" href="#specifying-the-policy-package-in-the-configuration-file" title="Direct link to heading">#</a></h3><p>It is likely that most experiments are already customising the Rucio
configuration file, in which case the policy package (<code>package = name</code> in
the <code>[policy]</code> section) can simply be added to the existing customised file.
Alternatively, the package name can be set in the <code>RUCIO_POLICY_PACKAGE</code>
environment variable (see previous section for how to pass environment
variables into the server container).</p><p>When deploying using Kubernetes and Helm charts, it is possible to specify
configuration options in <code>values.yaml</code>. Values included in the <code>config:</code>
section of this file are automatically merged into <code>rucio.cfg</code> by the
<code>docker-entrypoint.sh</code> script, so the policy package can be set as:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">policy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">package</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> packagename</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/rucio/documentation/tree/main/docs/../docs/policy_packages.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2022-10-26T15:49:44.000Z" class="lastUpdatedDate_nN9m">10/26/2022</time> by <strong>Rizart Dona</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/documentation/configure-rucio-globus"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Configure Rucio To Use Globus Online as a Transfer Tool</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/documentation/s3_rse_config"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">S3 Storage Configuration Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#creating-a-policy-package" class="table-of-contents__link">Creating a policy package</a></li><li><a href="#deploying-policy-packages-in-containers" class="table-of-contents__link">Deploying Policy Packages in containers</a><ul><li><a href="#installing-the-policy-package" class="table-of-contents__link">Installing the policy package</a></li><li><a href="#adding-the-policy-package-to-the-servers-pythonpath" class="table-of-contents__link">Adding the policy package to the server&#39;s PYTHONPATH</a></li><li><a href="#specifying-the-policy-package-in-the-configuration-file" class="table-of-contents__link">Specifying the policy package in the configuration file</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/documentation/img/rucio_horizontaled_black.svg" alt="" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/documentation/img/rucio_horizontaled_white.svg" alt="" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></div><div class="footer__copyright">Copyright Â© 2022 CERN</div></div></div></footer></div>
<script src="/documentation/assets/js/styles.de28298d.js"></script>
<script src="/documentation/assets/js/runtime~main.d7ca73f4.js"></script>
<script src="/documentation/assets/js/main.545e8c33.js"></script>
<script src="/documentation/assets/js/1.6e9b3614.js"></script>
<script src="/documentation/assets/js/2.d7582743.js"></script>
<script src="/documentation/assets/js/384.603d4a66.js"></script>
<script src="/documentation/assets/js/387.e975f881.js"></script>
<script src="/documentation/assets/js/935f2afb.1c30bcea.js"></script>
<script src="/documentation/assets/js/17896441.d8601507.js"></script>
<script src="/documentation/assets/js/040696f8.e955239f.js"></script>
</body>
</html>