(window.webpackJsonp=window.webpackJsonp||[]).push([[185],{255:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return d})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return s}));var o=n(3),l=n(7),i=(n(0),n(451)),r=["components"],a={title:"DownloadClient"},d={unversionedId:"client_api/downloadclient",id:"client_api/downloadclient",isDocsHomePage:!1,title:"DownloadClient",description:"\\\\init\\\\",source:"@site/../docs/client_api/downloadclient.md",sourceDirName:"client_api",slug:"/client_api/downloadclient",permalink:"/documentation/client_api/downloadclient",editUrl:"https://github.com/rucio/documentation/tree/main/docs/../docs/client_api/downloadclient.md",version:"current",frontMatter:{title:"DownloadClient"},sidebar:"docs",previous:{title:"DiracClient",permalink:"/documentation/client_api/diracclient"},next:{title:"ExportClient",permalink:"/documentation/client_api/exportclient"}},c=[{value:"__init__",id:"__init__",children:[]},{value:"download_pfns",id:"download_pfns",children:[]},{value:"download_dids",id:"download_dids",children:[]},{value:"download_from_metalink_file",id:"download_from_metalink_file",children:[]},{value:"download_aria2c",id:"download_aria2c",children:[]},{value:"preferred_impl",id:"preferred_impl",children:[]}],b={toc:c};function s(e){var t=e.components,n=Object(l.a)(e,r);return Object(i.b)("wrapper",Object(o.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"__init__"},"_","_","init","_","_"),Object(i.b)("span",{style:{"white-space":"pre"}},Object(i.b)("p",null,"Initialises the basic settings for an DownloadClient object"),Object(i.b)("table",{style:{border:"none"}},Object(i.b)("tbody",null,Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Arguments"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"client"),": Optional: rucio.client.client.Client object. If None, a new object will be created."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"external_traces"),": Optional: reference to a list where traces can be added"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"logger"),": Optional: logging.Logger object. If None, default logger will be used.")))))),Object(i.b)("h2",{id:"download_pfns"},"download","_","pfns"),Object(i.b)("span",{style:{"white-space":"pre"}},Object(i.b)("p",null,"Download items with a given PFN. This function can only download files, no datasets."),Object(i.b)("table",{style:{border:"none"}},Object(i.b)("tbody",null,Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Arguments"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"items"),": List of dictionaries. Each dictionary describing a file to download. Keys:\npfn                            - PFN string of this file\ndid                            - DID string of this file (e.g. 'scope:file.name'). Wildcards are not allowed\nrse                            - rse name (e.g. 'CERN-PROD_DATADISK'). RSE Expressions are not allowed\nbase_dir                       - Optional: Base directory where the downloaded files will be stored. (Default: '.')\nno_subdir                      - Optional: If true, files are written directly into base_dir. (Default: False)\nadler32                        - Optional: The adler32 checmsum to compare the downloaded files adler32 checksum with\nmd5                            - Optional: The md5 checksum to compare the downloaded files md5 checksum with\ntransfer_timeout               - Optional: Timeout time for the download protocols. (Default: None)\ncheck_local_with_filesize_only - Optional: If true, already downloaded files will not be validated by checksum."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"num_threads"),": Suggestion of number of threads to use for the download. It will be lowered if it's too high."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"trace_custom_fields"),": Custom key value pairs to send with the traces"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"traces_copy_out"),": reference to an external list, where the traces should be uploaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"deactivate_file_download_exceptions"),": Boolean, if file download exceptions shouldn't be raised"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Raises"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"InputValidationError"),": if one of the input items is in the wrong format"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"NoFilesDownloaded"),": if no files could be downloaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"NotAllFilesDownloaded"),": if not all files could be downloaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"RucioException"),": if something unexpected went wrong during the download"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Returns"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,"  a list of dictionaries with an entry for each file, containing the input options, the did, and the clientState\nclientState can be one of the following: ALREADY_DONE, DONE, FILE_NOT_FOUND, FAIL_VALIDATE, FAILED")))))),Object(i.b)("h2",{id:"download_dids"},"download","_","dids"),Object(i.b)("span",{style:{"white-space":"pre"}},Object(i.b)("p",null,"Download items with given DIDs. This function can also download datasets and wildcarded DIDs."),Object(i.b)("table",{style:{border:"none"}},Object(i.b)("tbody",null,Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Arguments"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"items"),": List of dictionaries. Each dictionary describing an item to download. Keys:\ndid                            - DID string of this file (e.g. 'scope:file.name')\nfilters                        - Filter to select DIDs for download. Optional if DID is given\nrse                            - Optional: rse name (e.g. 'CERN-PROD_DATADISK') or rse expression from where to download\nimpl                           - Optional: name of the protocol implementation to be used to download this item.\nno_resolve_archives            - Optional: bool indicating whether archives should not be considered for download (Default: False)\nresolve_archives               - Deprecated: Use no_resolve_archives instead\nforce_scheme                   - Optional: force a specific scheme to download this item. (Default: None)\nbase_dir                       - Optional: base directory where the downloaded files will be stored. (Default: '.')\nno_subdir                      - Optional: If true, files are written directly into base_dir. (Default: False)\nnrandom                        - Optional: if the DID addresses a dataset, nrandom files will be randomly choosen for download from the dataset\nignore_checksum                - Optional: If true, skips the checksum validation between the downloaded file and the rucio catalouge. (Default: False)\ntransfer_timeout               - Optional: Timeout time for the download protocols. (Default: None)\ntransfer_speed_timeout         - Optional: Minimum allowed transfer speed (in KBps). Ignored if transfer_timeout set. Otherwise, used to compute default timeout (Default: 500)\ncheck_local_with_filesize_only - Optional: If true, already downloaded files will not be validated by checksum."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"num_threads"),": Suggestion of number of threads to use for the download. It will be lowered if it's too high."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"trace_custom_fields"),": Custom key value pairs to send with the traces."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"traces_copy_out"),": reference to an external list, where the traces should be uploaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"deactivate_file_download_exceptions"),": Boolean, if file download exceptions shouldn't be raised"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"sort"),": Select best replica by replica sorting algorithm. Available algorithms:\n",Object(i.b)("inlineCode",{parentName:"p"},"geoip"),"       - based on src/dst IP topographical distance\n",Object(i.b)("inlineCode",{parentName:"p"},"closeness"),"   - based on src/dst closeness\n",Object(i.b)("inlineCode",{parentName:"p"},"dynamic"),"     - Rucio Dynamic Smart Sort (tm)"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Raises"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"InputValidationError"),": if one of the input items is in the wrong format"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"NoFilesDownloaded"),": if no files could be downloaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"NotAllFilesDownloaded"),": if not all files could be downloaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"RucioException"),": if something unexpected went wrong during the download"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Returns"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,"  a list of dictionaries with an entry for each file, containing the input options, the did, and the clientState")))))),Object(i.b)("h2",{id:"download_from_metalink_file"},"download","_","from","_","metalink","_","file"),Object(i.b)("span",{style:{"white-space":"pre"}},Object(i.b)("p",null,"Download items using a given metalink file."),Object(i.b)("table",{style:{border:"none"}},Object(i.b)("tbody",null,Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Arguments"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"item"),": dictionary describing an item to download. Keys:\nbase_dir                       - Optional: base directory where the downloaded files will be stored. (Default: '.')\nno_subdir                      - Optional: If true, files are written directly into base_dir. (Default: False)\nignore_checksum                - Optional: If true, skips the checksum validation between the downloaded file and the rucio catalouge. (Default: False)\ntransfer_timeout               - Optional: Timeout time for the download protocols. (Default: None)\ncheck_local_with_filesize_only - Optional: If true, already downloaded files will not be validated by checksum."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"num_threads"),": Suggestion of number of threads to use for the download. It will be lowered if it's too high."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"trace_custom_fields"),": Custom key value pairs to send with the traces."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"traces_copy_out"),": reference to an external list, where the traces should be uploaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"deactivate_file_download_exceptions"),": Boolean, if file download exceptions shouldn't be raised"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Raises"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"InputValidationError"),": if one of the input items is in the wrong format"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"NoFilesDownloaded"),": if no files could be downloaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"NotAllFilesDownloaded"),": if not all files could be downloaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"RucioException"),": if something unexpected went wrong during the download"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Returns"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,"  a list of dictionaries with an entry for each file, containing the input options, the did, and the clientState")))))),Object(i.b)("h2",{id:"download_aria2c"},"download","_","aria2c"),Object(i.b)("span",{style:{"white-space":"pre"}},Object(i.b)("p",null,"Uses aria2c to download the items with given DIDs. This function can also download datasets and wildcarded DIDs."),Object(i.b)("p",null,"It only can download files that are available via https/davs.\nAria2c needs to be installed and X509_USER_PROXY needs to be set!"),Object(i.b)("table",{style:{border:"none"}},Object(i.b)("tbody",null,Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Arguments"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"items"),": List of dictionaries. Each dictionary describing an item to download. Keys:\ndid                            - DID string of this file (e.g. 'scope:file.name'). Wildcards are not allowed\nrse                            - Optional: rse name (e.g. 'CERN-PROD_DATADISK') or rse expression from where to download\nbase_dir                       - Optional: base directory where the downloaded files will be stored. (Default: '.')\nno_subdir                      - Optional: If true, files are written directly into base_dir. (Default: False)\nnrandom                        - Optional: if the DID addresses a dataset, nrandom files will be randomly choosen for download from the dataset\nignore_checksum                - Optional: If true, skips the checksum validation between the downloaded file and the rucio catalouge. (Default: False)\ncheck_local_with_filesize_only - Optional: If true, already downloaded files will not be validated by checksum."),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"trace_custom_fields"),": Custom key value pairs to send with the traces"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"filters"),": dictionary containing filter options"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"deactivate_file_download_exceptions"),": Boolean, if file download exceptions shouldn't be raised"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"sort"),": Select best replica by replica sorting algorithm. Available algorithms:\n",Object(i.b)("inlineCode",{parentName:"p"},"geoip"),"       - based on src/dst IP topographical distance\n",Object(i.b)("inlineCode",{parentName:"p"},"closeness"),"   - based on src/dst closeness\n",Object(i.b)("inlineCode",{parentName:"p"},"dynamic"),"     - Rucio Dynamic Smart Sort (tm)"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Raises"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"InputValidationError"),": if one of the input items is in the wrong format"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"NoFilesDownloaded"),": if no files could be downloaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"NotAllFilesDownloaded"),": if not all files could be downloaded"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"RucioException"),": if something went wrong during the download (e.g. aria2c could not be started)"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Returns"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,"  a list of dictionaries with an entry for each file, containing the input options, the did, and the clientState")))))),Object(i.b)("h2",{id:"preferred_impl"},"preferred","_","impl"),Object(i.b)("span",{style:{"white-space":"pre"}},Object(i.b)("p",null,"Finds the optimum protocol impl preferred by the client and"),Object(i.b)("p",null,"supported by the remote RSE."),Object(i.b)("table",{style:{border:"none"}},Object(i.b)("tbody",null,Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Arguments"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"sources"),": List of sources for a given DID"))),Object(i.b)("tr",{style:{border:"none"}},Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Raises"),":")),Object(i.b)("td",{style:{border:"none",backgroundColor:"white",verticalAlign:"top"}},Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"RucioException(msg)"),": general exception with msg for more details.")))))))}s.isMDXComponent=!0},451:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return O}));var o=n(0),l=n.n(o);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,o,l=function(e,t){if(null==e)return{};var n,o,l={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var c=l.a.createContext({}),b=function(e){var t=l.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},s=function(e){var t=b(e.components);return l.a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return l.a.createElement(l.a.Fragment,{},t)}},u=l.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,r=e.parentName,c=d(e,["components","mdxType","originalType","parentName"]),s=b(n),u=o,O=s["".concat(r,".").concat(u)]||s[u]||p[u]||i;return n?l.a.createElement(O,a(a({ref:t},c),{},{components:n})):l.a.createElement(O,a({ref:t},c))}));function O(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=u;var a={};for(var d in t)hasOwnProperty.call(t,d)&&(a[d]=t[d]);a.originalType=e,a.mdxType="string"==typeof e?e:o,r[1]=a;for(var c=2;c<i;c++)r[c]=n[c];return l.a.createElement.apply(null,r)}return l.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);